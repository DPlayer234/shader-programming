// The CBuffer with the uniforms
cbuffer UniformBuffer
{
	matrix world;
	matrix view;
	matrix projection;
	float4 lightPos;

	float4 diffuseAlbedo;
	float4 specularAlbedo;
	float specularPower;
};

// The texture sent to the shader and the sample state used to sample it
Texture2D stexture;
SamplerState sampleType;

// Interpolated values passed by the vertex shader
struct PixelInputType
{
	float4 position : SV_POSITION;
	float4 color : COLOR;
	float2 tex : TEXCOORD0;
	float3 V : V;
	float3 N : N;
	float3 L : L;
};

// Pixel shader entry point
float4 main(PixelInputType input) : SV_TARGET
{
	// Compute the half-way vector for better performance than reflect()
	float3 H = normalize(input.L + input.V);
	
	float4 diffuse = max(dot(input.N, input.L), 0.0f) * diffuseAlbedo;
	float4 specular = pow(max(dot(input.N, H), 0.0f), specularPower) * specularAlbedo;

	return stexture.Sample(sampleType, input.tex) * input.color * float4((diffuse + specular).xyz, max(1.0f, diffuse.a + specular.a));
}
